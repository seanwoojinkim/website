---
import BaseLayout from '../layouts/BaseLayout.astro';
import ProjectCard from '../components/ProjectCard.astro';
import FillerBlock from '../components/FillerBlock.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).sort((a, b) => a.data.order - b.data.order);

// Calculate filler blocks needed to complete the grid
// Grid is typically 3 columns on desktop (auto-fit, minmax(280px, 1fr))
const COLUMNS = 3;
const fillersNeeded = (COLUMNS - (projects.length % COLUMNS)) % COLUMNS;
---

<BaseLayout title="Sean Kim â€” Interactive Systems" activePage="work">
    <header>
        <h1>Selected Work</h1>
        <p class="subtitle">
            Things I've been having fun working on and learning.
        </p>
    </header>

    <div class="grid">
        {projects.map((project, index) => (
            <ProjectCard
                title={project.data.title}
                description={project.data.description}
                status={project.data.status}
                category={project.data.category}
                number={String(index + 1).padStart(2, '0')}
                buttons={project.data.buttons}
            />
        ))}
        {Array.from({ length: fillersNeeded }, (_, i) => (
            <FillerBlock variant={(i % 3) + 1} />
        ))}
    </div>
</BaseLayout>
